<h2 data-ke-size="size26"><b>1. Introduction to WixSharp</b></h2>
<p data-ke-size="size16">&nbsp;If you have ever created an installation file for deploying Windows Desktop applications,
    you might have used the Wix toolset at least once. It is a powerful tool provided for free as open-source, but it
    has the inconvenience of having to write XML tags one by one. Especially for customizing the installation dialog,
    you need to specify the coordinates of each control one by one, and to verify it, you have to create the msi file
    and run it, which is quite inconvenient.</p>
<p data-ke-size="size16">&nbsp;WixSharp is a great tool that allows you to write these inconvenient XML tags in C# code.
    In particular, it is very convenient because you can implement the harvest of the installation target files simply
    using C# Linq without having to learn how to use the heat command and filter methods separately, and you can
    customize the WPF view directly on the designer screen.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">Github: <a href="https://github.com/oleg-shilo/wixsharp" target="_blank"
        rel="noopener">https://github.com/oleg-shilo/wixsharp</a></p>
<p data-ke-size="size16">&nbsp;</p>
<h2 data-ke-size="size26"><b>2. Installing WixSharp VS Extension</b></h2>
<p data-ke-size="size16">&nbsp;To use WixSharp, open the Visual Studio 2022 - Extensions menu =&gt; Manage Extensions
    window, search for wixsharp, and install the WixSharp Project Templates.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FPq8Y4%2Fbtsq0DYXMLn%2FQPDRoXQKpT4TF1VCG2jp4k%2Fimg.png"
        alt="">
</p>
<p data-ke-size="size16">&nbsp;</p>
<h2 data-ke-size="size26"><b>3. Creating a WixSharp Project</b></h2>
<p data-ke-size="size16">&nbsp;First, create a solution named WixSharpTest and a console application project named
    MyApp.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FQIv6m%2FbtsqYZ9TS8N%2FE1MENWBebzwK7mtFqpIbPk%2Fimg.png"
        alt="">

    <br>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FEMr9o%2FbtsqZDLBLzg%2FM4lv1ZrSjTZqWsgrq2lq9K%2Fimg.png"
        alt="">
</p>
<br>
<br>
<p data-ke-size="size16">Right-click on the solution and add a new project. Search for WixSharp, and several project
    templates will appear. Select Custom WPF UI.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbuULbX%2FbtsqYDF0Djb%2FNzkPGwuuv9CkXVgZMVWSqK%2Fimg.png"
        alt="">
</p>
<br>
<p data-ke-size="size16">Name the project MyAppInstaller.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcV1L1T%2Fbtsq2h1UOtT%2FDiWprQFm6Jc5BBDkojMdak%2Fimg.png"
        alt="">
</p>
<br>
<p data-ke-size="size16">Since the template references older versions of NuGet packages, update them to the latest
    versions.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdMInkm%2Fbtsq1ctgLCE%2FSthjrGu37RcoqSrZQhwRT1%2Fimg.png"
        alt="">
    <br>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FR2v8F%2FbtsqYZB0y9e%2FV8gNF8clKvREYq7cA92q1k%2Fimg.png"
        alt="">
</p>
<br>
<p data-ke-size="size16">&nbsp;</p>
<h2 data-ke-size="size26"><b>4. Building the Target Project and Installer Project</b></h2>
<p data-ke-size="size16">&nbsp;Modify the Program.cs file of the MyAppInstaller project as follows.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdfJY9k%2Fbtsq1bHMDoS%2FWBiipLpWbIttoqOEK13cIk%2Fimg.png"
        alt="">
</p>
<br>
<pre id="code_1691759011226" class="csharp" data-ke-language="csharp" data-ke-type="codeblock"><code>using System;
    using System.Windows.Forms;
    using WixSharp;
    using WixSharp.UI.WPF;
    
    namespace MyAppInstaller
    {
        internal class Program
        {
            static void Main()
            {
                var productName = "MyApp";
                var companyName = "HiperzStudio";
    
                var project = new ManagedProject($"{productName}",
                                  new Dir($@"%ProgramFiles%\{companyName}\{productName}",
                                      new Files("*.*")));
    
                project.GUID = new Guid("6fe30b47-2577-43ad-9095-1861ba25889b");
    
                // project.ManagedUI = ManagedUI.DefaultWpf; // all stock UI dialogs
    
                //custom set of UI WPF dialogs
                project.ManagedUI = new ManagedUI();
    
                project.ManagedUI.InstallDialogs.Add&lt;MyAppInstaller.WelcomeDialog&gt;()
                                                //.Add&lt;MyAppInstaller.LicenceDialog&gt;() // 라이센스 동의 화면 숨김
                                                //.Add&lt;MyAppInstaller.FeaturesDialog&gt;() // Feature 선택 화면 숨김
                                                .Add&lt;MyAppInstaller.InstallDirDialog&gt;()
                                                .Add&lt;MyAppInstaller.ProgressDialog&gt;()
                                                .Add&lt;MyAppInstaller.ExitDialog&gt;();
    
                project.ManagedUI.ModifyDialogs.Add&lt;MyAppInstaller.MaintenanceTypeDialog&gt;()
                                               //.Add&lt;MyAppInstaller.FeaturesDialog&gt;() // Feature 선택 화면 숨김
                                               .Add&lt;MyAppInstaller.ProgressDialog&gt;()
                                               .Add&lt;MyAppInstaller.ExitDialog&gt;();
    
                // Location of the application's binary files to be deployed
                project.SourceBaseDir = System.IO.Path.Combine(System.IO.Directory.GetCurrentDirectory(), @"..\MyApp\bin\debug\net6.0");

                // Folder to create MSI
                project.OutDir = System.IO.Path.Combine(System.IO.Directory.GetCurrentDirectory(), @"bin\deployment");
    
                project.BuildMsi();
            }
        }
    }</code></pre>
<br>
<p data-ke-size="size16">Now, if you build MyApp and then build MyAppInstaller, an msi file will be created in the
    bin\deployment folder.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbllnZC%2Fbtsq1I6qRG6%2FmqPG5GdCCoANcJMLTSD350%2Fimg.png"
        alt="">
    <br>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtmSjq%2FbtsqZtWLWlG%2FPuCn4mBHVXrupxL187ysnk%2Fimg.png"
        alt="">
</p>
<br>
<p data-ke-size="size16">When you run MyApp.msi, you will see the installation GUI as shown below. It's very simple,
    right?</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FT5ybc%2Fbtsq1aITxRS%2FxTkneKLzIjEOLkBHw5YTKK%2Fimg.png"
        alt="">
</p>
<br>
<p data-ke-size="size16">Now, if you proceed with the installation, you can see that it is installed correctly under the
    Program Files folder as shown below.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbLGZe6%2Fbtsq2kYDXlK%2FK3raCASSVuXJqT1CxjoP10%2Fimg.png"
        alt="">
</p>
<br>
<p data-ke-size="size16">You can also see that MyApp appears in the list in the Windows Add or Remove Programs console
    as shown below.</p>
<p>
    <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdCfM0i%2FbtsqZbB4fYi%2Fkf5PeDtwjdD7qShdtk6R4k%2Fimg.png"
        alt="">
</p>
<br>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">In the next post, we will learn how to filter the target files for deployment and create
    shortcut icons on the desktop and start menu.</p>